
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Minimum, Maximum, and Mixture &#8212; Think Bayes</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.e8f53015daec13862f6db5e763c41738.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Poisson Processes" href="chap08.html" />
    <link rel="prev" title="Odds and Addends" href="chap06.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      <h1 class="site-logo" id="site-title">Think Bayes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   Think Bayes 2
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="preface.html">
   Preface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap01.html">
   Probability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap02.html">
   Bayes’s Theorem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap03.html">
   Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap04.html">
   Estimating Proportions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap05.html">
   Estimating Counts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap06.html">
   Odds and Addends
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Minimum, Maximum, and Mixture
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap08.html">
   Poisson Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap09.html">
   Decision Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap10.html">
   Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap11.html">
   Comparison
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap12.html">
   Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap13.html">
   Inference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap14.html">
   Survival Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap15.html">
   Mark and Recapture
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap16.html">
   Logistic Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap17.html">
   Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap18.html">
   Conjugate Priors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap19.html">
   MCMC
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chap20.html">
   Approximate Bayesian Computation
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Examples
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="redline.html">
   The Red Line Problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="vaccine2.html">
   Estimating vaccine efficacy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="usb.html">
   Flipping USB Connectors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sister.html">
   The Left Handed Sister Problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bayes_dice.html">
   Bayesian Dice
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="radiation.html">
   The Emitter-Detector Problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hospital.html">
   Grid algorithms for hierarchical models
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/chap07.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/AllenDowney/ThinkBayes2"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/AllenDowney/ThinkBayes2/master?urlpath=tree/chap07.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cumulative-distribution-functions">
   Cumulative Distribution Functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#best-three-of-four">
   Best Three of Four
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#maximum">
   Maximum
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#minimum">
   Minimum
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mixture">
   Mixture
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#general-mixtures">
   General Mixtures
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="minimum-maximum-and-mixture">
<h1>Minimum, Maximum, and Mixture<a class="headerlink" href="#minimum-maximum-and-mixture" title="Permalink to this headline">¶</a></h1>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get utils.py</span>

<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">basename</span><span class="p">,</span> <span class="n">exists</span>

<span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlretrieve</span>
        <span class="n">local</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Downloaded &#39;</span> <span class="o">+</span> <span class="n">local</span><span class="p">)</span>
    
<span class="n">download</span><span class="p">(</span><span class="s1">&#39;https://github.com/AllenDowney/ThinkBayes2/raw/master/soln/utils.py&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the previous chapter we computed distributions of sums.
In this chapter, we’ll compute distributions of minimums and maximums, and use them to solve both forward and inverse problems.</p>
<p>Then we’ll look at distributions that are mixtures of other distributions, which will turn out to be particularly useful for making predictions.</p>
<p>But we’ll start with a powerful tool for working with distributions, the cumulative distribution function.</p>
<div class="section" id="cumulative-distribution-functions">
<h2>Cumulative Distribution Functions<a class="headerlink" href="#cumulative-distribution-functions" title="Permalink to this headline">¶</a></h2>
<p>So far we have been using probability mass functions to represent distributions.
A useful alternative is the <strong>cumulative distribution function</strong>, or CDF.</p>
<p>As an example, I’ll use the posterior distribution from the Euro problem, which we computed in &lt;&lt;_BayesianEstimation&gt;&gt;.</p>
<p>Here’s the uniform prior we started with.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">empiricaldist</span> <span class="kn">import</span> <span class="n">Pmf</span>

<span class="n">hypos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<span class="n">pmf</span> <span class="o">=</span> <span class="n">Pmf</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">hypos</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">250</span>
</pre></div>
</div>
</div>
</div>
<p>And here’s the update.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binom</span>

<span class="k">def</span> <span class="nf">update_binomial</span><span class="p">(</span><span class="n">pmf</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Update pmf using the binomial distribution.&quot;&quot;&quot;</span>
    <span class="n">k</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">pmf</span><span class="o">.</span><span class="n">qs</span>
    <span class="n">likelihood</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">xs</span><span class="p">)</span>
    <span class="n">pmf</span> <span class="o">*=</span> <span class="n">likelihood</span>
    <span class="n">pmf</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">update_binomial</span><span class="p">(</span><span class="n">pmf</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The CDF is the cumulative sum of the PMF, so we can compute it like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cumulative</span> <span class="o">=</span> <span class="n">pmf</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Here’s what it looks like, along with the PMF.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">decorate</span>

<span class="k">def</span> <span class="nf">decorate_euro</span><span class="p">(</span><span class="n">title</span><span class="p">):</span>
    <span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Proportion of heads (x)&#39;</span><span class="p">,</span>
             <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Probability&#39;</span><span class="p">,</span>
             <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cumulative</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;CDF&#39;</span><span class="p">)</span>
<span class="n">pmf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;PMF&#39;</span><span class="p">)</span>
<span class="n">decorate_euro</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Posterior distribution for the Euro problem&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap07_15_0.png" src="_images/chap07_15_0.png" />
</div>
</div>
<p>The range of the CDF is always from 0 to 1, in contrast with the PMF, where the maximum can be any probability.</p>
<p>The result from <code class="docutils literal notranslate"><span class="pre">cumsum</span></code> is a Pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code>, so we can use the bracket operator to select an element:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cumulative</span><span class="p">[</span><span class="mf">0.61</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9638303193984253
</pre></div>
</div>
</div>
</div>
<p>The result is about 0.96, which means that the total probability of all quantities less than or equal to 0.61 is 96%.</p>
<p>To go the other way — to look up a probability and get the corresponding quantile — we can use interpolation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>

<span class="n">ps</span> <span class="o">=</span> <span class="n">cumulative</span><span class="o">.</span><span class="n">values</span>
<span class="n">qs</span> <span class="o">=</span> <span class="n">cumulative</span><span class="o">.</span><span class="n">index</span>

<span class="n">interp</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">qs</span><span class="p">)</span>
<span class="n">interp</span><span class="p">(</span><span class="mf">0.96</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array(0.60890171)
</pre></div>
</div>
</div>
</div>
<p>The result is about 0.61, so that confirms that the 96th percentile of this distribution is 0.61.</p>
<p><code class="docutils literal notranslate"><span class="pre">empiricaldist</span></code> provides a class called <code class="docutils literal notranslate"><span class="pre">Cdf</span></code> that represents a cumulative distribution function.
Given a <code class="docutils literal notranslate"><span class="pre">Pmf</span></code>, you can compute a <code class="docutils literal notranslate"><span class="pre">Cdf</span></code> like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cdf</span> <span class="o">=</span> <span class="n">pmf</span><span class="o">.</span><span class="n">make_cdf</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">make_cdf</span></code> uses <code class="docutils literal notranslate"><span class="pre">np.cumsum</span></code> to compute the cumulative sum of the probabilities.</p>
<p>You can use brackets to select an element from a <code class="docutils literal notranslate"><span class="pre">Cdf</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cdf</span><span class="p">[</span><span class="mf">0.61</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9638303193984253
</pre></div>
</div>
</div>
</div>
<p>But if you look up a quantity that’s not in the distribution, you get a <code class="docutils literal notranslate"><span class="pre">KeyError</span></code>.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">cdf</span><span class="p">[</span><span class="mf">0.615</span><span class="p">]</span>
<span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KeyError(0.615)
</pre></div>
</div>
</div>
</div>
<p>To avoid this problem, you can call a <code class="docutils literal notranslate"><span class="pre">Cdf</span></code> as a function, using parentheses.
If the argument does not appear in the <code class="docutils literal notranslate"><span class="pre">Cdf</span></code>, it interpolates between quantities.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cdf</span><span class="p">(</span><span class="mf">0.615</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array(0.96383032)
</pre></div>
</div>
</div>
</div>
<p>Going the other way, you can use <code class="docutils literal notranslate"><span class="pre">quantile</span></code> to look up a cumulative probability and get the corresponding quantity:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cdf</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.9638303</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array(0.61)
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Cdf</span></code> also provides <code class="docutils literal notranslate"><span class="pre">credible_interval</span></code>, which computes a credible interval that contains the given probability:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cdf</span><span class="o">.</span><span class="n">credible_interval</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.51, 0.61])
</pre></div>
</div>
</div>
</div>
<p>CDFs and PMFs are equivalent in the sense that they contain the
same information about the distribution, and you can always convert
from one to the other.
Given a <code class="docutils literal notranslate"><span class="pre">Cdf</span></code>, you can get the equivalent <code class="docutils literal notranslate"><span class="pre">Pmf</span></code> like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pmf</span> <span class="o">=</span> <span class="n">cdf</span><span class="o">.</span><span class="n">make_pmf</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">make_pmf</span></code> uses <code class="docutils literal notranslate"><span class="pre">np.diff</span></code> to compute differences between consecutive cumulative probabilities.</p>
<p>One reason <code class="docutils literal notranslate"><span class="pre">Cdf</span></code> objects are useful is that they compute quantiles efficiently.
Another is that they make it easy to compute the distribution of a maximum or minimum, as we’ll see in the next section.</p>
</div>
<div class="section" id="best-three-of-four">
<h2>Best Three of Four<a class="headerlink" href="#best-three-of-four" title="Permalink to this headline">¶</a></h2>
<p>In <em>Dungeons &amp; Dragons</em>, each character has six attributes: strength, intelligence, wisdom, dexterity, constitution, and charisma.</p>
<p>To generate a new character, players roll four 6-sided dice for each attribute and add up the best three.
For example, if I roll for strength and get 1, 2, 3, 4 on the dice, my character’s strength would be the sum of 2, 3, and 4, which is 9.</p>
<p>As an exercise, let’s figure out the distribution of these attributes.
Then, for each character, we’ll figure out the distribution of their best attribute.</p>
<p>I’ll import two functions from the previous chapter: <code class="docutils literal notranslate"><span class="pre">make_die</span></code>, which makes a <code class="docutils literal notranslate"><span class="pre">Pmf</span></code> that represents the outcome of rolling a die, and <code class="docutils literal notranslate"><span class="pre">add_dist_seq</span></code>, which takes a sequence of <code class="docutils literal notranslate"><span class="pre">Pmf</span></code> objects and computes the distribution of their sum.</p>
<p>Here’s a <code class="docutils literal notranslate"><span class="pre">Pmf</span></code> that represents a six-sided die and a sequence with three references to it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">make_die</span>

<span class="n">die</span> <span class="o">=</span> <span class="n">make_die</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">dice</span> <span class="o">=</span> <span class="p">[</span><span class="n">die</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<p>And here’s the distribution of the sum of three dice.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">add_dist_seq</span>

<span class="n">pmf_3d6</span> <span class="o">=</span> <span class="n">add_dist_seq</span><span class="p">(</span><span class="n">dice</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here’s what it looks like:</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">decorate_dice</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Outcome&#39;</span><span class="p">,</span>
             <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;PMF&#39;</span><span class="p">,</span>
             <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pmf_3d6</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate_dice</span><span class="p">(</span><span class="s1">&#39;Distribution of attributes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap07_41_0.png" src="_images/chap07_41_0.png" />
</div>
</div>
<p>If we roll four dice and add up the best three, computing the distribution of the sum is a bit more complicated.
I’ll estimate the distribution by simulating 10,000 rolls.</p>
<p>First I’ll create an array of random values from 1 to 6, with 10,000 rows and 4 columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>To find the best three outcomes in each row, I’ll use <code class="docutils literal notranslate"><span class="pre">sort</span></code> with <code class="docutils literal notranslate"><span class="pre">axis=1</span></code>, which sorts the rows in ascending order.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, I’ll select the last three columns and add them up.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now <code class="docutils literal notranslate"><span class="pre">t</span></code> is an array with a single column and 10,000 rows.
We can compute the PMF of the values in <code class="docutils literal notranslate"><span class="pre">t</span></code> like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pmf_best3</span> <span class="o">=</span> <span class="n">Pmf</span><span class="o">.</span><span class="n">from_seq</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The following figure shows the distribution of the sum of three dice, <code class="docutils literal notranslate"><span class="pre">pmf_3d6</span></code>, and the distribution of the best three out of four, <code class="docutils literal notranslate"><span class="pre">pmf_best3</span></code>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pmf_3d6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;sum of 3 dice&#39;</span><span class="p">)</span>
<span class="n">pmf_best3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;best 3 of 4&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">decorate_dice</span><span class="p">(</span><span class="s1">&#39;Distribution of attributes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap07_51_0.png" src="_images/chap07_51_0.png" />
</div>
</div>
<p>As you might expect, choosing the best three out of four tends to yield higher values.</p>
<p>Next we’ll find the distribution for the maximum of six attributes, each the sum of the best three of four dice.</p>
</div>
<div class="section" id="maximum">
<h2>Maximum<a class="headerlink" href="#maximum" title="Permalink to this headline">¶</a></h2>
<p>To compute the distribution of a maximum or minimum, we can make good use of the cumulative distribution function.
First, I’ll compute the <code class="docutils literal notranslate"><span class="pre">Cdf</span></code> of the best three of four distribution:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cdf_best3</span> <span class="o">=</span> <span class="n">pmf_best3</span><span class="o">.</span><span class="n">make_cdf</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Recall that <code class="docutils literal notranslate"><span class="pre">Cdf(x)</span></code> is the sum of probabilities for quantities less than or equal to <code class="docutils literal notranslate"><span class="pre">x</span></code>.
Equivalently, it is the probability that a random value chosen from the distribution is less than or equal to <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p>Now suppose I draw 6 values from this distribution.
The probability that all 6 of them are less than or equal to <code class="docutils literal notranslate"><span class="pre">x</span></code> is <code class="docutils literal notranslate"><span class="pre">Cdf(x)</span></code> raised to the 6th power, which we can compute like this:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cdf_best3</span><span class="o">**</span><span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3     1.000000e-18
4     1.077922e-14
5     4.608274e-12
6     6.327115e-10
7     4.348387e-08
8     1.800749e-06
9     3.278401e-05
10    4.798287e-04
11    3.763756e-03
12    2.025453e-02
13    8.123653e-02
14    2.198825e-01
15    4.534313e-01
16    7.121818e-01
17    9.027888e-01
18    1.000000e+00
Name: , dtype: float64
</pre></div>
</div>
</div>
</div>
<p>If all 6 values are less than or equal to <code class="docutils literal notranslate"><span class="pre">x</span></code>, that means that their maximum is less than or equal to <code class="docutils literal notranslate"><span class="pre">x</span></code>.
So the result is the CDF of their maximum.
We can convert it to a <code class="docutils literal notranslate"><span class="pre">Cdf</span></code> object, like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">empiricaldist</span> <span class="kn">import</span> <span class="n">Cdf</span>

<span class="n">cdf_max6</span> <span class="o">=</span> <span class="n">Cdf</span><span class="p">(</span><span class="n">cdf_best3</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And compute the equivalent <code class="docutils literal notranslate"><span class="pre">Pmf</span></code> like this:</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pmf_max6</span> <span class="o">=</span> <span class="n">cdf_max6</span><span class="o">.</span><span class="n">make_pmf</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The following figure shows the result.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pmf_max6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;max of 6 attributes&#39;</span><span class="p">)</span>

<span class="n">decorate_dice</span><span class="p">(</span><span class="s1">&#39;Distribution of attributes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap07_62_0.png" src="_images/chap07_62_0.png" />
</div>
</div>
<p>Most characters have at least one attribute greater than 12; almost 10% of them have an 18.</p>
<p>The following figure shows the CDFs for the three distributions we have computed.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">cdf_3d6</span> <span class="o">=</span> <span class="n">pmf_3d6</span><span class="o">.</span><span class="n">make_cdf</span><span class="p">()</span>
<span class="n">cdf_3d6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;sum of 3 dice&#39;</span><span class="p">)</span>

<span class="n">cdf_best3</span> <span class="o">=</span> <span class="n">pmf_best3</span><span class="o">.</span><span class="n">make_cdf</span><span class="p">()</span>
<span class="n">cdf_best3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;best 3 of 4 dice&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">cdf_max6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;max of 6 attributes&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

<span class="n">decorate_dice</span><span class="p">(</span><span class="s1">&#39;Distribution of attributes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;CDF&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap07_65_0.png" src="_images/chap07_65_0.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Cdf</span></code> provides <code class="docutils literal notranslate"><span class="pre">max_dist</span></code>, which does the same computation, so we can also compute the <code class="docutils literal notranslate"><span class="pre">Cdf</span></code> of the maximum like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cdf_max_dist6</span> <span class="o">=</span> <span class="n">cdf_best3</span><span class="o">.</span><span class="n">max_dist</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the next section we’ll find the distribution of the minimum.
The process is similar, but a little more complicated.
See if you can figure it out before you go on.</p>
</div>
<div class="section" id="minimum">
<h2>Minimum<a class="headerlink" href="#minimum" title="Permalink to this headline">¶</a></h2>
<p>In the previous section we computed the distribution of a character’s best attribute.
Now let’s compute the distribution of the worst.</p>
<p>To compute the distribution of the minimum, we’ll use the <strong>complementary CDF</strong>, which we can compute like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob_gt</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">cdf_best3</span>
</pre></div>
</div>
</div>
</div>
<p>As the variable name suggests, the complementary CDF is the probability that a value from the distribution is greater than <code class="docutils literal notranslate"><span class="pre">x</span></code>.
If we draw 6 values from the distribution, the probability that all 6 exceed <code class="docutils literal notranslate"><span class="pre">x</span></code> is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob_gt6</span> <span class="o">=</span> <span class="n">prob_gt</span><span class="o">**</span><span class="mi">6</span>
</pre></div>
</div>
</div>
</div>
<p>If all 6 exceed <code class="docutils literal notranslate"><span class="pre">x</span></code>, that means their minimum exceeds <code class="docutils literal notranslate"><span class="pre">x</span></code>, so <code class="docutils literal notranslate"><span class="pre">prob_gt6</span></code> is the complementary CDF of the minimum.
And that means we can compute the CDF of the minimum like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob_le6</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">prob_gt6</span>
</pre></div>
</div>
</div>
</div>
<p>The result is a Pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code> that represents the CDF of the minimum of six attributes.  We can put those values in a <code class="docutils literal notranslate"><span class="pre">Cdf</span></code> object like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cdf_min6</span> <span class="o">=</span> <span class="n">Cdf</span><span class="p">(</span><span class="n">prob_le6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here’s what it looks like, along with the distribution of the maximum.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cdf_min6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;minimum of 6&#39;</span><span class="p">)</span>
<span class="n">cdf_max6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;maximum of 6&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<span class="n">decorate_dice</span><span class="p">(</span><span class="s1">&#39;Minimum and maximum of six attributes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;CDF&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap07_80_0.png" src="_images/chap07_80_0.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Cdf</span></code> provides <code class="docutils literal notranslate"><span class="pre">min_dist</span></code>, which does the same computation, so we can also compute the <code class="docutils literal notranslate"><span class="pre">Cdf</span></code> of the minimum like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cdf_min_dist6</span> <span class="o">=</span> <span class="n">cdf_best3</span><span class="o">.</span><span class="n">min_dist</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And we can confirm that the differences are small.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">cdf_min_dist6</span><span class="p">,</span> <span class="n">cdf_min6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>In the exercises at the end of this chapter, you’ll use distributions of the minimum and maximum to do Bayesian inference.
But first we’ll see what happens when we mix distributions.</p>
</div>
<div class="section" id="mixture">
<h2>Mixture<a class="headerlink" href="#mixture" title="Permalink to this headline">¶</a></h2>
<p>In this section I’ll show how we can compute a distribution which is a mixture of other distributions.
I’ll explain what that means with some simple examples;
then, more usefully, we’ll see how these mixtures are used to make predictions.</p>
<p>Here’s another example inspired by <em>Dungeons &amp; Dragons</em>:</p>
<ul class="simple">
<li><p>Suppose your character is armed with a dagger in one hand and a short sword in the other.</p></li>
<li><p>During each round, you attack a monster with one of your two weapons, chosen at random.</p></li>
<li><p>The dagger causes one 4-sided die of damage; the short sword causes one 6-sided die of damage.</p></li>
</ul>
<p>What is the distribution of damage you inflict in each round?</p>
<p>To answer this question, I’ll make a <code class="docutils literal notranslate"><span class="pre">Pmf</span></code> to represent the 4-sided and 6-sided dice:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d4</span> <span class="o">=</span> <span class="n">make_die</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">d6</span> <span class="o">=</span> <span class="n">make_die</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now, let’s compute the probability you inflict 1 point of damage.</p>
<ul class="simple">
<li><p>If you attacked with the dagger, it’s 1/4.</p></li>
<li><p>If you attacked with the short sword, it’s 1/6.</p></li>
</ul>
<p>Because the probability of choosing either weapon is 1/2, the total probability is the average:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">d4</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">d6</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">prob_1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.20833333333333331
</pre></div>
</div>
</div>
</div>
<p>For the outcomes 2, 3, and 4, the probability is the same, but for 5 and 6 it’s different, because those outcomes are impossible with the 4-sided die.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob_6</span> <span class="o">=</span> <span class="p">(</span><span class="n">d4</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">d6</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">prob_6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.08333333333333333
</pre></div>
</div>
</div>
</div>
<p>To compute the distribution of the mixture, we could loop through the possible outcomes and compute their probabilities.</p>
<p>But we can do the same computation using the <code class="docutils literal notranslate"><span class="pre">+</span></code> operator:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mix1</span> <span class="o">=</span> <span class="p">(</span><span class="n">d4</span> <span class="o">+</span> <span class="n">d6</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>Here’s what the mixture of these distributions looks like.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mix1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">decorate_dice</span><span class="p">(</span><span class="s1">&#39;Mixture of one 4-sided and one 6-sided die&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap07_95_0.png" src="_images/chap07_95_0.png" />
</div>
</div>
<p>Now suppose you are fighting three monsters:</p>
<ul class="simple">
<li><p>One has a club, which causes one 4-sided die of damage.</p></li>
<li><p>One has a mace, which causes one 6-sided die.</p></li>
<li><p>And one has a quarterstaff, which also causes one 6-sided die.</p></li>
</ul>
<p>Because the melee is disorganized, you are attacked by one of these monsters each round, chosen at random.
To find the distribution of the damage they inflict, we can compute a weighted average of the distributions, like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mix2</span> <span class="o">=</span> <span class="p">(</span><span class="n">d4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">d6</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<p>This distribution is a mixture of one 4-sided die and two 6-sided dice.
Here’s what it looks like.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mix2</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">decorate_dice</span><span class="p">(</span><span class="s1">&#39;Mixture of one 4-sided and two 6-sided die&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap07_99_0.png" src="_images/chap07_99_0.png" />
</div>
</div>
<p>In this section we used the <code class="docutils literal notranslate"><span class="pre">+</span></code> operator, which adds the probabilities in the distributions, not to be confused with <code class="docutils literal notranslate"><span class="pre">Pmf.add_dist</span></code>, which computes the distribution of the sum of the distributions.</p>
<p>To demonstrate the difference, I’ll use <code class="docutils literal notranslate"><span class="pre">Pmf.add_dist</span></code> to compute the distribution of the total damage done per round, which is the sum of the two mixtures:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total_damage</span> <span class="o">=</span> <span class="n">Pmf</span><span class="o">.</span><span class="n">add_dist</span><span class="p">(</span><span class="n">mix1</span><span class="p">,</span> <span class="n">mix2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And here’s what it looks like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total_damage</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">decorate_dice</span><span class="p">(</span><span class="s1">&#39;Total damage inflicted by both parties&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap07_103_0.png" src="_images/chap07_103_0.png" />
</div>
</div>
</div>
<div class="section" id="general-mixtures">
<h2>General Mixtures<a class="headerlink" href="#general-mixtures" title="Permalink to this headline">¶</a></h2>
<p>In the previous section we computed mixtures in an <em>ad hoc</em> way.
Now we’ll see a more general solution.
In future chapters, we’ll use this solution to generate predictions for real-world problems, not just role-playing games.
But if you’ll bear with me, we’ll continue the previous example for one more section.</p>
<p>Suppose three more monsters join the combat, each of them with a battle axe that causes one 8-sided die of damage.
Still, only one monster attacks per round, chosen at random, so the damage they inflict is a mixture of:</p>
<ul class="simple">
<li><p>One 4-sided die,</p></li>
<li><p>Two 6-sided dice, and</p></li>
<li><p>Three 8-sided dice.</p></li>
</ul>
<p>I’ll use a <code class="docutils literal notranslate"><span class="pre">Pmf</span></code> to represent a randomly chosen monster:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hypos</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>
<span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">pmf_dice</span> <span class="o">=</span> <span class="n">Pmf</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">hypos</span><span class="p">)</span>
<span class="n">pmf_dice</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="n">pmf_dice</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>probs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>0.166667</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.500000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This distribution represents the number of sides on the die we’ll roll and the probability of rolling each one.
For example, one of the six monsters has a dagger, so the probability is <span class="math notranslate nohighlight">\(1/6\)</span> that we roll a 4-sided die.</p>
<p>Next I’ll make a sequence of <code class="docutils literal notranslate"><span class="pre">Pmf</span></code> objects to represent the dice:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dice</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_die</span><span class="p">(</span><span class="n">sides</span><span class="p">)</span> <span class="k">for</span> <span class="n">sides</span> <span class="ow">in</span> <span class="n">hypos</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>To compute the distribution of the mixture, I’ll compute the weighted average of the dice, using the probabilities in <code class="docutils literal notranslate"><span class="pre">pmf_dice</span></code> as the weights.</p>
<p>To express this computation concisely, it is convenient to put the distributions into a Pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dice</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th></th>
      <td>0.250000</td>
      <td>0.250000</td>
      <td>0.250000</td>
      <td>0.250000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th></th>
      <td>0.166667</td>
      <td>0.166667</td>
      <td>0.166667</td>
      <td>0.166667</td>
      <td>0.166667</td>
      <td>0.166667</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th></th>
      <td>0.125000</td>
      <td>0.125000</td>
      <td>0.125000</td>
      <td>0.125000</td>
      <td>0.125000</td>
      <td>0.125000</td>
      <td>0.125</td>
      <td>0.125</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The result is a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> with one row for each distribution and one column for each possible outcome.
Not all rows are the same length, so Pandas fills the extra spaces with the special value <code class="docutils literal notranslate"><span class="pre">NaN</span></code>, which stands for “not a number”.
We can use <code class="docutils literal notranslate"><span class="pre">fillna</span></code> to replace the <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values with 0.</p>
<p>The next step is to multiply each row by the probabilities in <code class="docutils literal notranslate"><span class="pre">pmf_dice</span></code>, which turns out to be easier if we transpose the matrix so the distributions run down the columns rather than across the rows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dice</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.25</td>
      <td>0.166667</td>
      <td>0.125</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.25</td>
      <td>0.166667</td>
      <td>0.125</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.25</td>
      <td>0.166667</td>
      <td>0.125</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.25</td>
      <td>0.166667</td>
      <td>0.125</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.00</td>
      <td>0.166667</td>
      <td>0.125</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.00</td>
      <td>0.166667</td>
      <td>0.125</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.125</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.125</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now we can multiply by the probabilities in <code class="docutils literal notranslate"><span class="pre">pmf_dice</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">*=</span> <span class="n">pmf_dice</span><span class="o">.</span><span class="n">ps</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.041667</td>
      <td>0.055556</td>
      <td>0.0625</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.041667</td>
      <td>0.055556</td>
      <td>0.0625</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.041667</td>
      <td>0.055556</td>
      <td>0.0625</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.041667</td>
      <td>0.055556</td>
      <td>0.0625</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.000000</td>
      <td>0.055556</td>
      <td>0.0625</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.000000</td>
      <td>0.055556</td>
      <td>0.0625</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0625</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0625</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>And add up the weighted distributions:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1    0.159722
2    0.159722
3    0.159722
4    0.159722
5    0.118056
6    0.118056
7    0.062500
8    0.062500
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The argument <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> means we want to sum across the rows.
The result is a Pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p>
<p>Putting it all together, here’s a function that makes a weighted mixture of distributions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_mixture</span><span class="p">(</span><span class="n">pmf</span><span class="p">,</span> <span class="n">pmf_seq</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Make a mixture of distributions.&quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pmf_seq</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">df</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pmf</span><span class="p">)</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Pmf</span><span class="p">(</span><span class="n">total</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The first parameter is a <code class="docutils literal notranslate"><span class="pre">Pmf</span></code> that maps from each hypothesis to a probability.
The second parameter is a sequence of <code class="docutils literal notranslate"><span class="pre">Pmf</span></code> objects, one for each hypothesis.
We can call it like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mix</span> <span class="o">=</span> <span class="n">make_mixture</span><span class="p">(</span><span class="n">pmf_dice</span><span class="p">,</span> <span class="n">dice</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And here’s what it looks like.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mix</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;mixture&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">decorate_dice</span><span class="p">(</span><span class="s1">&#39;Distribution of damage with three different weapons&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap07_125_0.png" src="_images/chap07_125_0.png" />
</div>
</div>
<p>In this section I used Pandas so that <code class="docutils literal notranslate"><span class="pre">make_mixture</span></code> is concise, efficient, and hopefully not too hard to understand.
In the exercises at the end of the chapter, you’ll have a chance to practice with mixtures, and we will use <code class="docutils literal notranslate"><span class="pre">make_mixture</span></code> again in the next chapter.</p>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>This chapter introduces the <code class="docutils literal notranslate"><span class="pre">Cdf</span></code> object, which represents the cumulative distribution function (CDF).</p>
<p>A <code class="docutils literal notranslate"><span class="pre">Pmf</span></code> and the corresponding <code class="docutils literal notranslate"><span class="pre">Cdf</span></code> are equivalent in the sense that they contain the same information, so you can convert from one to the other.<br />
The primary difference between them is performance: some operations are faster and easier with a <code class="docutils literal notranslate"><span class="pre">Pmf</span></code>; others are faster with a <code class="docutils literal notranslate"><span class="pre">Cdf</span></code>.</p>
<p>In this chapter we used <code class="docutils literal notranslate"><span class="pre">Cdf</span></code> objects to compute distributions of maximums and minimums; these distributions are useful for inference if we are given a maximum or minimum as data.
You will see some examples in the exercises, and in future chapters.
We also computed mixtures of distributions, which we will use in the next chapter to make predictions.</p>
<p>But first you might want to work on these exercises.</p>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<p><strong>Exercise:</strong> When you generate a D&amp;D character, instead of rolling dice, you can use the “standard array” of attributes, which is 15, 14, 13, 12, 10, and 8.
Do you think you are better off using the standard array or (literally) rolling the dice?</p>
<p>Compare the distribution of the values in the standard array to the distribution we computed for the best three out of four:</p>
<ul class="simple">
<li><p>Which distribution has higher mean?  Use the <code class="docutils literal notranslate"><span class="pre">mean</span></code> method.</p></li>
<li><p>Which distribution has higher standard deviation?  Use the <code class="docutils literal notranslate"><span class="pre">std</span></code> method.</p></li>
<li><p>The lowest value in the standard array is 8.  For each attribute, what is the probability of getting a value less than 8?  If you roll the dice six times, what’s the probability that at least one of your attributes is less than 8?</p></li>
<li><p>The highest value in the standard array is 15.  For each attribute, what is the probability of getting a value greater than 15?  If you roll the dice six times, what’s the probability that at least one of your attributes is greater than 15?</p></li>
</ul>
<p>To get you started, here’s a <code class="docutils literal notranslate"><span class="pre">Cdf</span></code> that represents the distribution of attributes in the standard array:</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">standard</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>
<span class="n">cdf_standard</span> <span class="o">=</span> <span class="n">Cdf</span><span class="o">.</span><span class="n">from_seq</span><span class="p">(</span><span class="n">standard</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can compare it to the distribution of attributes you get by rolling four dice at adding up the best three.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cdf_best3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;best 3 of 4&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">cdf_standard</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;standard set&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C7&#39;</span><span class="p">)</span>

<span class="n">decorate_dice</span><span class="p">(</span><span class="s1">&#39;Distribution of attributes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;CDF&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap07_133_0.png" src="_images/chap07_133_0.png" />
</div>
</div>
<p>I plotted <code class="docutils literal notranslate"><span class="pre">cdf_standard</span></code> as a step function to show more clearly that it contains only a few quantities.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="c1"># Here are the means</span>
<span class="n">cdf_best3</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">cdf_standard</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(12.1677, 12.0)
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="c1"># And the standard deviations</span>
<span class="n">cdf_best3</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="n">cdf_standard</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2.8544660989403954, 2.3804761428476167)
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="c1"># Here&#39;s the probability that a single attribute is less than 8</span>
<span class="n">cdf_best3</span><span class="o">.</span><span class="n">lt_dist</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.059300000000000005
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="c1"># And the probability that a single attribute is greater than 15</span>
<span class="n">cdf_best3</span><span class="o">.</span><span class="n">gt_dist</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.12349999999999994
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="c1"># Here are two ways to compute the probability that at</span>
<span class="c1"># least one attribute is less than 8</span>
<span class="n">cdf_min6</span><span class="o">.</span><span class="n">lt_dist</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">cdf_best3</span><span class="o">.</span><span class="n">lt_dist</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">**</span><span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.30704207784407456, 0.30704207784407456)
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="c1"># And two ways to compute the probability that at least</span>
<span class="c1"># one attribute is greater than 15</span>
<span class="n">cdf_max6</span><span class="o">.</span><span class="n">gt_dist</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">cdf_best3</span><span class="o">.</span><span class="n">gt_dist</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">**</span><span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.5465686720682852, 0.5465686720682852)
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise:</strong> Suppose you are fighting three monsters:</p>
<ul class="simple">
<li><p>One is armed with a short sword that causes one 6-sided die of damage,</p></li>
<li><p>One is armed with a battle axe that causes one 8-sided die of damage, and</p></li>
<li><p>One is armed with a bastard sword that causes one 10-sided die of damage.</p></li>
</ul>
<p>One of the monsters, chosen at random, attacks you and does 1 point of damage.</p>
<p>Which monster do you think it was?  Compute the posterior probability that each monster was the attacker.</p>
<p>If the same monster attacks you again, what is the probability that you suffer 6 points of damage?</p>
<p>Hint: Compute a posterior distribution as we have done before and pass it as one of the arguments to <code class="docutils literal notranslate"><span class="pre">make_mixture</span></code>.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="c1"># Here&#39;s what we believe about the dice after seeing the data</span>

<span class="n">hypos</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">prior</span> <span class="o">=</span> <span class="n">Pmf</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">hypos</span><span class="p">)</span>
<span class="n">likelihood</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">prior</span><span class="o">.</span><span class="n">qs</span>
<span class="n">posterior</span> <span class="o">=</span> <span class="n">prior</span> <span class="o">*</span> <span class="n">likelihood</span>
<span class="n">posterior</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="n">posterior</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>probs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>0.425532</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.319149</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.255319</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="c1"># Here&#39;s a sequence that represents the three dice</span>

<span class="n">d6</span> <span class="o">=</span> <span class="n">make_die</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">d8</span> <span class="o">=</span> <span class="n">make_die</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="n">d10</span> <span class="o">=</span> <span class="n">make_die</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">dice</span> <span class="o">=</span> <span class="n">d6</span><span class="p">,</span> <span class="n">d8</span><span class="p">,</span> <span class="n">d10</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="c1"># And here&#39;s a mixture of the three dice, weighting</span>
<span class="c1"># each one with the probability from the posterior distribution</span>

<span class="n">mix3</span> <span class="o">=</span> <span class="n">make_mixture</span><span class="p">(</span><span class="n">posterior</span><span class="p">,</span> <span class="n">dice</span><span class="p">)</span>
<span class="n">mix3</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap07_144_0.png" src="_images/chap07_144_0.png" />
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="c1"># From the mixture, we can pull out the probability of</span>
<span class="c1"># rolling a 6.</span>

<span class="n">mix3</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.13634751773049647
</pre></div>
</div>
</div>
</div>
<p><strong>Exercise:</strong> Henri Poincaré was a French mathematician who taught at the Sorbonne around 1900. The following anecdote about him is probably fiction, but it makes an interesting probability problem.</p>
<p>Supposedly Poincaré suspected that his local bakery was selling loaves of bread that were lighter than the advertised weight of 1 kg, so every day for a year he bought a loaf of bread, brought it home and weighed it. At the end of the year, he plotted the distribution of his measurements and showed that it fit a normal distribution with mean 950 g and standard deviation 50 g. He brought this evidence to the bread police, who gave the baker a warning.</p>
<p>For the next year, Poincaré continued to weigh his bread every day. At the end of the year, he found that the average weight was 1000 g, just as it should be, but again he complained to the bread police, and this time they fined the baker.</p>
<p>Why? Because the shape of the new distribution was asymmetric. Unlike the normal distribution, it was skewed to the right, which is consistent with the hypothesis that the baker was still making 950 g loaves, but deliberately giving Poincaré the heavier ones.</p>
<p>To see whether this anecdote is plausible, let’s suppose that when the baker sees Poincaré coming, he hefts <code class="docutils literal notranslate"><span class="pre">n</span></code> loaves of bread and gives Poincaré the heaviest one.  How many loaves would the baker have to heft to make the average of the maximum 1000 g?</p>
<p>To get you started, I’ll generate a year’s worth of data from a normal distribution with the given parameters.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span> <span class="o">=</span> <span class="mi">950</span>
<span class="n">std</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">365</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="c1"># Here&#39;s the mean of the maximum of `n` loaves,</span>
<span class="c1"># for a range of values of `n`</span>

<span class="n">cdf</span> <span class="o">=</span> <span class="n">Cdf</span><span class="o">.</span><span class="n">from_seq</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
    <span class="n">cdf_max</span> <span class="o">=</span> <span class="n">cdf</span><span class="o">.</span><span class="n">max_dist</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">cdf_max</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2 978.4666876067706
3 992.7589004318227
4 1002.0372868686195
5 1008.8226939493089
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution</span>

<span class="c1"># It looks like hefting 4 loaves is enough to get the mean over 1000,</span>
<span class="c1"># so the story is not entirely implausible.</span>

<span class="c1"># Here&#39;s what the distribution of the maximum looks like, compared</span>
<span class="c1"># to the actual distribution of weights.</span>

<span class="n">cdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;one loaf&#39;</span><span class="p">)</span>
<span class="n">cdf</span><span class="o">.</span><span class="n">max_dist</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;maximum of four loaves&#39;</span><span class="p">)</span>

<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Weight in grams&#39;</span><span class="p">,</span>
         <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;CDF&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chap07_150_0.png" src="_images/chap07_150_0.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="chap06.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Odds and Addends</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="chap08.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Poisson Processes</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Allen B. Downey<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>